---
import { getCollection, render } from 'astro:content';
import type { CollectionEntry } from 'astro:content';
import BaseLayout from '../../layouts/base-layout.astro';
import { slugify } from "../../lib/utils";

export interface Props {
    post: CollectionEntry<'blog'>;
}

export const getStaticPaths = async () => {
    const posts = await getCollection('blog');
    return posts.map((post) => ({
        params: { slug: slugify(post.data.title) },
        props: { post }
    }));
};

const { post } = Astro.props;
const { Content } = await render(post);
---

<BaseLayout title={`Blog | ${post.data.title}`}>
    <article class="flex flex-col gap-4">
        <h1 
            class="text-4xl" 
            transition:name={`post-title-${post.data.title}`}
        >
            {post.data.title}
        </h1>
        <p class="lead">{post.data.content}</p>
        <Content />
    </article>
</BaseLayout>
